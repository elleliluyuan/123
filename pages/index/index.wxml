<!--pages/index/index.wxml-->
<view class="container">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="page-title">完美💩记</text>
  </view>

  <!-- 宠物切换标签 -->
  <view class="pet-tabs">
    <scroll-view class="pet-tabs-scroll" scroll-x="true" show-scrollbar="false">
      <view class="pet-tabs-container">
        <view 
          wx:for="{{pets}}"
          wx:key="id"
          class="pet-tab {{currentPetId === item.id ? 'active' : ''}}"
          catchtap="selectPet"
          data-pet-id="{{item.id}}"
        >
          <text class="pet-tab-name">{{item.name}}</text>
          <view class="pet-tab-underline" wx:if="{{currentPetId === item.id}}"></view>
        </view>
        <view class="add-pet-tab" catchtap="addPet">
          <text class="add-pet-icon">+</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 宠物信息卡片 -->
  <view class="pet-info-card">
    <view class="pet-info-content">
      <view class="pet-avatar-section">
        <view class="pet-avatar-large">
          <image wx:if="{{currentPet.avatar}}" src="{{currentPet.avatar}}" class="pet-avatar-image" mode="aspectFill"></image>
          <text wx:else class="pet-emoji">{{currentPet.emoji}}</text>
        </view>
      </view>
      <view class="pet-details">
        <view class="pet-basic-info">
          <view class="info-item">
            <text class="info-label">年龄</text>
            <text class="info-value">{{currentPet.age}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">性别</text>
            <text class="info-value">{{currentPet.gender}}</text>
          </view>
          <view class="info-item">
            <text class="info-label">体重</text>
            <text class="info-value">{{currentPet.weight}}</text>
          </view>
        </view>
        <view class="pet-cute-phrase">
          <text class="phrase-text">{{currentPet.phrase}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 首页内容 -->
  <view class="home-content">
    <!-- 日历卡片 -->
    <view class="calendar-card">
      <view class="calendar-header">
        <view class="month-arrow left-arrow" catchtap="previousMonth">
          <text class="arrow-icon">‹</text>
        </view>
        <text class="current-month">{{currentMonth}}</text>
        <view class="month-arrow right-arrow" catchtap="nextMonth">
          <text class="arrow-icon">›</text>
        </view>
      </view>
      <!-- 星期标题 -->
      <view class="weekday-header">
        <view class="weekday-item" wx:for="{{weekdays}}" wx:key="*this">
          <text class="weekday-text">{{item}}</text>
        </view>
      </view>
      
      <view class="calendar-grid">
        <view 
          class="calendar-day {{item.isToday ? 'today' : ''}} {{item.hasRecord ? 'has-record' : ''}} {{item.isAbnormal ? 'abnormal' : ''}}"
          wx:for="{{calendarDays}}" 
          wx:key="date"
          bindtap="viewDayRecord"
          data-date="{{item.date}}"
        >
          <text class="day-number">{{item.day}}</text>
          <text class="poop-icon" wx:if="{{item.poopIcon}}">{{item.poopIcon}}</text>
        </view>
      </view>
    </view>

    <!-- 周总结卡片 -->
    <view class="weekly-summary">
      <view class="summary-header">
        <text class="summary-title">📊 本周总结</text>
      </view>
      <text class="summary-text">{{weeklySummary}}</text>
    </view>
  </view>
  <!-- 自定义底部三频道入口 -->
  <view class="bottom-channels">
    <!-- 左频道：首页 -->
    <view class="channel-entry active" catchtap="switchChannel" data-channel="home">
      <view class="channel-icon">🏠</view>
    </view>
    
    <!-- 中间加号按钮 -->
    <view class="add-button" catchtap="addRecord">
      <text class="add-icon">+</text>
    </view>
    
    <!-- 右频道：AI -->
    <view class="channel-entry" catchtap="switchChannel" data-channel="ai">
      <view class="channel-icon">🤖</view>
    </view>
  </view>

</view>